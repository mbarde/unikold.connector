<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="unikold.connector">
<body>

<metal:main fill-slot="main">
  <tal:main-macro metal:define-macro="main">

    <h1>Test SOAP</h1>
    <form id="formImport" method="GET"
          tal:attributes="action view/request/URL">

      <input type="checkbox" name="isLSFRequest" id="isLSFRequest"
            tal:attributes="checked python: view.request.form.get('isLSFRequest', False)"/>
      <label for="isLSFRequest">LSF Request</label>
      <span>Antwort wird entsprechend nachbereitet und damit besser lesbar.</span>
      <br/>

      <label for="wsdlUrl">WSDL Url</label>
      <input type="text" name="wsdlUrl" id="wsdlUrl"
             tal:attributes="value python: view.request.form.get('wsdlUrl', '')"/>

      <label for="wsdlMethod">WSDL Methode</label>
      <input type="text" name="wsdlMethod" id="wsdlMethod"
             tal:attributes="value python: view.request.form.get('wsdlMethod', '')"/>

      <label for="method">Methode</label>
      <input type="text" name="method" id="method" placeholder="alleSemester"
             tal:attributes="value python: view.request.form.get('method', '')"/>

      <input type="checkbox" name="useAuthentication" id="useAuthentication"
             tal:attributes="checked python: view.request.form.get('useAuthentication', False)"/>
      <label for="useAuthentication">Mit Authentifizierung</label>
      <span>Nutzername und Passwort müssen im LSF-Controlpanel gesetzt worden sein</span>
      <br/>
      <label for="parameters">Parameter</label><br/>
      <span>Pro Zeile ein Parameter in dem Format: <pre>name:wert</pre></span>
      <textarea name="parameters" id="parameters" rows="10"
                tal:content="python: view.request.form.get('parameters', '')"></textarea>

      <label for="soapRequest">SOAP Request</label><br/>
      <span>Wird hier der SOAP Request per Hand eingetragen, werden die Eingaben für Methode und Parameter ignoriert.</span>
      <textarea name="soapRequest" id="soapRequest" rows="10"
                tal:content="python: view.request.form.get('soapRequest', '')"></textarea>
      <br/>

      <input type="submit" id="btn-submit" class="btn btn-primary" value="Abschicken">
      <span id="submit-loading" style="display:none">Lade ...</span>
    </form>

    <div id="soap-result" tal:condition="view/soapRequestAsString">
      <h3>Ergebnis</h3>

      <label>SOAP-Request</label>
      <pre tal:content="view/soapRequestAsString"></pre>

      <tal:soap-error condition="view/soapError">
      <label>Fehler</label>
      <pre tal:content="view/soapError"></pre>
      </tal:soap-error>

      <tal:soap-result condition="view/soapResult">
      <label>Antwort</label>
      <pre tal:content="view/soapResult"></pre>
      </tal:soap-result>
    </div>

    <script>
      $(document).ready(function() {
        $('#btn-submit').click(function() {
          $('#btn-submit').hide();
          $('#submit-loading').show();
        });

        var divResult = $('#soap-result');
        if (divResult) {
          var pos = divResult.offset().top;
          $('html, body').animate({ scrollTop: pos }, 1000);
        }
      })
    </script>

  </tal:main-macro>
</metal:main>

</body>
</html>
